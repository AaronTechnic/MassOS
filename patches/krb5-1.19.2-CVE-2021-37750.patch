diff -ruN old/src/kdc/do_tgs_req.c new/src/kdc/do_tgs_req.c
--- old/src/kdc/do_tgs_req.c	2021-07-22 16:50:07.000000000 +0100
+++ new/src/kdc/do_tgs_req.c	2021-10-19 17:28:54.066158970 +0100
@@ -208,6 +208,11 @@
         goto cleanup;
     }
 
+if (sprinc == NULL) {
+       status = "NULL_SERVER";
+       errcode = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;
+       goto cleanup;
+       }
     errcode = get_local_tgt(kdc_context, &sprinc->realm, header_server,
                             &local_tgt, &local_tgt_storage, &local_tgt_key);
     if (errcode) {
